<div class="banner_container">
    <img src="" id="main_image" class="main_image" alt="">
    <div class="missing_out_div">
        <p onclick="javascript:toggle_news_form()">Fear of missing out?<i id="fear_caret" class="fa fa-caret-down"></i></p>
        <div class="hidden_newsletter_form">
            <form style="font-size:12px" id="banner_newsletter">
                <span><input id="banner_email" name="cm-iixuu-iixuu" type="email" required  placeholder="Email address"/><button type="submit" id="banner_submit">Subscribe</button></span><br>
                        <input id="banner_agree_terms" type="checkbox" required value="I agree to receive newsletters from The Bay Centre">I agree to receive newsletters from The Bay Centre
                        
                         <input type="hidden" name="cm-f-jhtykd" id ="banner_source" />
                         <input type="hidden" name="cm-f-jhtykh" id="banner_terms"/>
            </form>
        </div>
    </div>
</div>
<div class="share_this_icon_div">
    <span class='st_sharethis'></span>   
</div>


<div class="map_container" id="mapsvg"></div>
<input type="hidden" id ="testme" value="stores_x5F_3_x5F_6_2_ : {tooltip: 'TEST'}"/>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.4/raphael-min.js"></script>
<script type="text/javascript" src="http://assets.kodekloud.io/sites/556628266e6f640eb3000000/138b043444ee6b5e381a27b2103d101a/jquery.mousewheel.js"></script>
<script type="text/javascript" src="http://assets.kodekloud.io/sites/556628266e6f640eb3000000/74141f4e7fc21d1457d2be79b85990c1/mallmaverick_svgmap.js"></script>
<script>
    $("#left_image").attr("src", "http://assets.kodekloud.io/sites/556628266e6f640eb3000000/46aca5797e3b84bd6d66160428052711/findstore_banner3.jpg");
    $("#right_image").attr("src", "http://assets.kodekloud.io/sites/556628266e6f640eb3000000/46aca5797e3b84bd6d66160428052711/findstore_banner2.jpg");
    $("#main_image").attr("src", "http://assets.kodekloud.io/sites/556628266e6f640eb3000000/46aca5797e3b84bd6d66160428052711/findstore_banner1.jpg");
</script>


<script>

function drop_pin(id){
            var coords = map.get_coords(id);
            var height = parseInt(coords["height"])
            var width = parseInt(coords["width"])
            var x_offset = (parseInt(width) / 2);
            var y_offset = (parseInt(height) /2);
            map.setMarks([{ xy: [coords["x"] - 25 + x_offset, coords["y"] - 85 + y_offset],
                      attrs: {
                                src:  'http://cdn.mallmaverick.com/system/sites/map_markers/000/000/056/original/map_pincopy.png?1423594955'     // image for marker
                              }
                    }
                    ])
        }
    $(document).ready(function() {
        function renderAll (){
            var stores = getStoresList();
            regions = {}
            $.each( stores , function( key, val ) {
                if(val.svgmap_region != null && typeof(val.svgmap_region)  != 'undefined'){
                    obj = {};
                    obj["tooltip"] = "<div class='tooltip_div'><p class='tooltip_name'>"+val.name+"</p></div>"
                    obj["attr"] = {}
                    obj["attr"]["href"] = "/stores/"+val.slug
                    regions[val.svgmap_region] = obj
                }
            });
            
            load_map(regions)
            
        }
        function renderPageData(container, template, collection, type){
            
        }
        
        
        
    
        function load_map(reg){
            map = $('#mapsvg').mapSvg({
                source: getSVGMapURL(),    // Path to SVG map
                colors: {stroke: '#aaaaaa', selected: -20, hover: "#99CA3C"},
                disableAll: true,
                height:800,
                width:1193,
                regions: reg,
                tooltipsMode:'custom',
                loadingText: "loading...",
                zoom: true,
                zoomButtons: {'show': true,'location': 'left' },
                pan:true,
                cursor:'pointer',
                responsive:true,
                zoomLimit: [0,10]
            });
        }
        loadMallData(renderAll);  
    })
    
    
    
</script>