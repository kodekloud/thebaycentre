<style>
    .store_detail_description{
        margin-top:15px;
    }
</style>
<div class="banner_container">
    <img src="" id="main_image" class="main_image" alt="">
    <div class="missing_out_div">
        <p onclick="javascript:toggle_news_form()">Fear of missing out?<i id="fear_caret" class="fa fa-caret-down"></i></p>
        <div class="hidden_newsletter_form">
            <form style="font-size:12px" id="banner_newsletter">
                <span><input id="banner_email" name="cm-iixuu-iixuu" type="email" required  placeholder="Email address"/><button type="submit" id="banner_submit">Subscribe</button></span><br>
                        <input id="banner_agree_terms" type="checkbox" required value="I agree to receive newsletters from The Bay Centre">I agree to receive newsletters from The Bay Centre
                        
                         <input type="hidden" name="cm-f-jhtykd" id ="banner_source" />
                         <input type="hidden" name="cm-f-jhtykh" id="banner_terms"/>
            </form>
        </div>
    </div>
</div>
<div class="share_this_icon_div">
    <span class='st_sharethis'></span>   
</div>


<div class="store_detail_content">
    
    <div class="detail_left_div">
        <div id="pop-over">
            
        </div>
        <div id="promo_title_container">
            <script id="promo_title_template" type="x-tmpl-mustache/text">
                <p class="store_detail_title">{{name}}</p>
                
            </script>
        </div>
        <div id="store_detail_left_content_container">
            <script id="store_detail_left_content_template" type="x-tmpl-mustache/text">
                <p class="promo_dates">{{date_string}}</p>
                <p class="store_detail_description">{{description}}</p>
            </script>
        </div>
    </div>
    <div class="detail_right_div">
        <div id="store_detail_right_content_container">
            <script id="store_detail_right_content_template" type="x-tmpl-mustache/text">
                <a href="{{alt_store_front_url}}" rel="lightbox-gallery" title="{{name}}">
                    <img class="store_front" alt="photo_{{name}}" src="{{alt_store_front_url}}"/>
                </a>
                
            </script>
        </div>
    </div>
</div>



<!--For more information please see http://learnjs.io/blog/2013/11/30/snapsvg-resources/-->
<script src="//cdnjs.cloudflare.com/ajax/libs/snap.svg/0.3.0/snap.svg-min.js"></script>
<script src="http://kodekloud.s3.amazonaws.com/sites/5422419e4a616d74d9030000/e1fb5e17ab727d248230fbcb51da868f/jquery.panzoom.min.js"></script>

<script>
    var pathArray = window.location.pathname.split( '/' );
    var slug = pathArray[pathArray.length-1];
    promo_details = getContestBySlug(slug);
    if (promo_details.eventable_type == "Store"){
        var store_details = getStoreDetailsByID(promo_details.eventable_id)
        if (store_details.gallery ){
            $("#main_image").attr("src", "http://cdn.mallmaverick.com/"+store_details.gallery[0]);
            $("#left_image").attr("src", "http://cdn.mallmaverick.com/"+store_details.gallery[1]);
            $("#right_image").attr("src", "http://cdn.mallmaverick.com/"+store_details.gallery[2]);
        } else {
            $("#main_image").attr("src", "http://assets.kodekloud.io/sites/556628266e6f640eb3000000/8dbac6c93fba1a1cc183512cb3213260/events_banner1.jpg");
            $("#left_image").attr("src", "http://assets.kodekloud.io/sites/556628266e6f640eb3000000/8dbac6c93fba1a1cc183512cb3213260/events_banner3.jpg");
            $("#right_image").attr("src", "http://assets.kodekloud.io/sites/556628266e6f640eb3000000/8dbac6c93fba1a1cc183512cb3213260/events_banner2.jpg");
        }
    } else {
        $("#main_image").attr("src", "http://assets.kodekloud.io/sites/556628266e6f640eb3000000/8dbac6c93fba1a1cc183512cb3213260/events_banner1.jpg");
        $("#left_image").attr("src", "http://assets.kodekloud.io/sites/556628266e6f640eb3000000/8dbac6c93fba1a1cc183512cb3213260/events_banner3.jpg");
        $("#right_image").attr("src", "http://assets.kodekloud.io/sites/556628266e6f640eb3000000/8dbac6c93fba1a1cc183512cb3213260/events_banner2.jpg");
    }
    
    $(document).ready(function() {
        function renderPageData(){
            
           

            renderDetailData("#store_detail_right_content_container", "#store_detail_right_content_template", promo_details, "prop_promo")
            $("#contact_map").hide();
            $("#contact_phone").hide();
            $("#contact_website").hide();
            $(".map_div").hide();
            
            
            renderDetailData("#promo_title_container", "#promo_title_template", promo_details, "prop_promo")
            
            renderDetailData("#store_detail_left_content_container", "#store_detail_left_content_template", promo_details, "prop_promo")
            
            renderDetailData("#store_detail_hours_container","#store_detail_hours_template", hours, "store_hours")
            
            $.getScript("http://cdn.jsdelivr.net/slimbox/2.0.5/js/slimbox2.js");
            $('head').append('<link rel="stylesheet" href="http://cdn.jsdelivr.net/slimbox/2.0.5/css/slimbox2.css" type="text/css" media="screen" />');
        }
        
        function renderDetailData(container, template, collection, type){
            var item_list = [];
            var item_rendered = [];
            var template_html = $(template).html();
            Mustache.parse(template_html);   // optional, speeds up future uses
            if (type == "store_desc" || type == "prop_promo"){
                item_list.push(collection);    
                collection = item_list;    
            }
            
            
            $.each( collection , function( key, val ) {
                
                
                if ((promo_details.event_image_url).indexOf('missing.png') > -1){
                    val.alt_store_front_url = "http://assets.kodekloud.io/sites/556628266e6f640eb3000000/d52d75490b904799149bedd8a0f02ffe/storedetail_default.jpg"
                } else {
                    val.alt_store_front_url = getImageURL(promo_details.event_image_url);
                }

                
                
                var rendered = Mustache.render(template_html,val);
                item_rendered.push(rendered);

            
                $(container).show();
                $(container).html(item_rendered.join(''));
            });
        }
        
        loadMallData(renderPageData);
        
        
    });
</script>